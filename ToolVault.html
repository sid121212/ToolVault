<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ToolVault ‚Äî Every Calculator You Need</title>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Mono:wght@300;400;500&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet"/>
<style>
:root {
  --bg:#080B11;--bg2:#0D1117;--bg3:#131920;--border:#1E2730;--border2:#263040;
  --text:#E8EDF5;--muted:#6B7A8F;--muted2:#3D4F63;--accent:#3B82F6;--accent2:#60A5FA;
  --green:#10B981;--orange:#F59E0B;--pink:#EC4899;--purple:#8B5CF6;--cyan:#06B6D4;--red:#EF4444;
  --card:#0F1620;--card2:#141C28;--radius:14px;--radius-sm:8px;--shadow:0 4px 24px rgba(0,0,0,0.4);
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
html{scroll-behavior:smooth;}
body{background:var(--bg);color:var(--text);font-family:'DM Sans',sans-serif;font-size:15px;min-height:100vh;overflow-x:hidden;}
body::before{content:'';position:fixed;inset:0;z-index:0;pointer-events:none;
  background:radial-gradient(ellipse 80% 50% at 50% -10%,rgba(59,130,246,0.08),transparent);}
nav{position:sticky;top:0;z-index:100;display:flex;align-items:center;justify-content:space-between;
  padding:0 32px;height:60px;background:rgba(8,11,17,0.9);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);}
.nav-logo{font-family:'Syne',sans-serif;font-weight:800;font-size:20px;letter-spacing:-0.5px;display:flex;align-items:center;gap:8px;}
.nav-logo span{color:var(--accent);}
.nav-badge{font-family:'DM Mono',monospace;font-size:10px;background:rgba(59,130,246,0.12);color:var(--accent2);
  border:1px solid rgba(59,130,246,0.25);padding:2px 8px;border-radius:20px;}
.nav-search{display:flex;align-items:center;gap:8px;background:var(--bg3);border:1px solid var(--border);
  border-radius:8px;padding:6px 14px;width:260px;transition:border-color 0.2s;}
.nav-search:focus-within{border-color:var(--accent);}
.nav-search input{background:none;border:none;outline:none;color:var(--text);font-family:'DM Sans',sans-serif;font-size:14px;width:100%;}
.nav-search input::placeholder{color:var(--muted);}
.hero{position:relative;z-index:1;padding:72px 32px 56px;text-align:center;}
.hero h1{font-family:'Syne',sans-serif;font-weight:800;font-size:clamp(36px,5vw,60px);letter-spacing:-2px;line-height:1.05;margin-bottom:16px;}
.hero h1 em{font-style:normal;background:linear-gradient(135deg,var(--accent2),var(--cyan));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
.hero p{color:var(--muted);font-size:16px;max-width:480px;margin:0 auto 32px;}
.hero-stats{display:flex;justify-content:center;gap:40px;flex-wrap:wrap;}
.stat-num{font-family:'Syne',sans-serif;font-weight:800;font-size:30px;}
.stat-label{font-size:12px;color:var(--muted);margin-top:2px;}
.cats-wrap{position:relative;z-index:1;padding:0 32px 28px;display:flex;gap:10px;flex-wrap:wrap;justify-content:center;}
.cat-btn{display:flex;align-items:center;gap:8px;padding:9px 20px;border-radius:50px;border:1px solid var(--border);
  background:var(--card);color:var(--muted);cursor:pointer;font-family:'DM Sans',sans-serif;font-size:13px;font-weight:500;transition:all 0.2s;}
.cat-btn:hover{border-color:var(--border2);color:var(--text);}
.cat-btn.active{background:var(--accent);border-color:var(--accent);color:#fff;}
.tools-section{position:relative;z-index:1;padding:0 32px 80px;max-width:1340px;margin:0 auto;}
.section-header{display:flex;align-items:center;gap:12px;margin-bottom:20px;padding-bottom:16px;border-bottom:1px solid var(--border);}
.section-header h2{font-family:'Syne',sans-serif;font-weight:700;font-size:20px;letter-spacing:-0.5px;}
.section-count{font-family:'DM Mono',monospace;font-size:11px;background:var(--bg3);color:var(--muted);border:1px solid var(--border);border-radius:20px;padding:2px 10px;}
.tools-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(230px,1fr));gap:14px;margin-bottom:52px;}
.tool-card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:22px;cursor:pointer;transition:all 0.2s;position:relative;overflow:hidden;}
.tool-card::after{content:'‚Üí';position:absolute;right:18px;top:22px;font-size:14px;color:var(--muted2);transition:all 0.2s;opacity:0;}
.tool-card:hover{border-color:var(--border2);transform:translateY(-2px);box-shadow:var(--shadow);}
.tool-card:hover::after{opacity:1;right:14px;color:var(--muted);}
.tool-card::before{content:'';position:absolute;inset:0;opacity:0;transition:opacity 0.3s;border-radius:var(--radius);}
.tool-card:hover::before{opacity:1;}
.c-blue::before{background:linear-gradient(135deg,rgba(59,130,246,0.07),transparent);}
.c-green::before{background:linear-gradient(135deg,rgba(16,185,129,0.07),transparent);}
.c-orange::before{background:linear-gradient(135deg,rgba(245,158,11,0.07),transparent);}
.c-pink::before{background:linear-gradient(135deg,rgba(236,72,153,0.07),transparent);}
.c-purple::before{background:linear-gradient(135deg,rgba(139,92,246,0.07),transparent);}
.c-cyan::before{background:linear-gradient(135deg,rgba(6,182,212,0.07),transparent);}
.tool-icon-wrap{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px;margin-bottom:14px;position:relative;z-index:1;}
.c-blue .tool-icon-wrap{background:rgba(59,130,246,0.12);}
.c-green .tool-icon-wrap{background:rgba(16,185,129,0.12);}
.c-orange .tool-icon-wrap{background:rgba(245,158,11,0.12);}
.c-pink .tool-icon-wrap{background:rgba(236,72,153,0.12);}
.c-purple .tool-icon-wrap{background:rgba(139,92,246,0.12);}
.c-cyan .tool-icon-wrap{background:rgba(6,182,212,0.12);}
.tool-name{font-family:'Syne',sans-serif;font-weight:700;font-size:15px;margin-bottom:5px;position:relative;z-index:1;}
.tool-desc{font-size:12px;color:var(--muted);line-height:1.5;position:relative;z-index:1;}
.tool-tag{display:inline-block;margin-top:10px;font-family:'DM Mono',monospace;font-size:10px;padding:2px 8px;border-radius:4px;position:relative;z-index:1;}
.c-blue .tool-tag{background:rgba(59,130,246,0.1);color:var(--accent2);}
.c-green .tool-tag{background:rgba(16,185,129,0.1);color:var(--green);}
.c-orange .tool-tag{background:rgba(245,158,11,0.1);color:var(--orange);}
.c-pink .tool-tag{background:rgba(236,72,153,0.1);color:var(--pink);}
.c-purple .tool-tag{background:rgba(139,92,246,0.1);color:var(--purple);}
.c-cyan .tool-tag{background:rgba(6,182,212,0.1);color:var(--cyan);}
.modal-overlay{position:fixed;inset:0;z-index:500;background:rgba(4,6,10,0.88);backdrop-filter:blur(10px);
  display:flex;align-items:center;justify-content:center;padding:20px;opacity:0;pointer-events:none;transition:opacity 0.25s;}
.modal-overlay.open{opacity:1;pointer-events:all;}
.modal{background:var(--bg2);border:1px solid var(--border2);border-radius:20px;width:100%;max-width:600px;
  max-height:92vh;overflow-y:auto;padding:32px;transform:translateY(20px) scale(0.97);transition:transform 0.25s;box-shadow:0 32px 80px rgba(0,0,0,0.6);}
.modal-overlay.open .modal{transform:translateY(0) scale(1);}
.modal-header{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:28px;}
.modal-title-wrap{display:flex;align-items:center;gap:14px;}
.modal-icon{width:48px;height:48px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0;}
.modal-title{font-family:'Syne',sans-serif;font-weight:800;font-size:22px;letter-spacing:-0.5px;}
.modal-subtitle{font-size:13px;color:var(--muted);margin-top:2px;}
.modal-close{background:var(--bg3);border:1px solid var(--border);color:var(--muted);width:34px;height:34px;
  border-radius:8px;cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center;transition:all 0.15s;flex-shrink:0;}
.modal-close:hover{border-color:var(--border2);color:var(--text);}
.field-group{display:grid;grid-template-columns:1fr 1fr;gap:14px;}
.field{margin-bottom:16px;}
.field.full{grid-column:1/-1;}
label{display:block;font-size:11px;font-weight:500;color:var(--muted);margin-bottom:6px;
  font-family:'DM Mono',monospace;letter-spacing:0.5px;text-transform:uppercase;}
input[type="number"],input[type="text"],select,textarea{width:100%;background:var(--bg3);border:1px solid var(--border);
  border-radius:var(--radius-sm);color:var(--text);font-family:'DM Sans',sans-serif;font-size:14px;
  padding:10px 14px;outline:none;transition:border-color 0.2s;-webkit-appearance:none;}
input:focus,select:focus,textarea:focus{border-color:var(--accent);}
input::placeholder{color:var(--muted2);}
select option{background:var(--bg3);}
textarea{resize:vertical;min-height:90px;}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:11px 22px;border-radius:var(--radius-sm);
  font-family:'DM Sans',sans-serif;font-size:14px;font-weight:500;cursor:pointer;border:none;transition:all 0.2s;}
.btn-primary{background:var(--accent);color:#fff;}
.btn-primary:hover{background:#2563EB;transform:translateY(-1px);}
.btn-secondary{background:var(--bg3);border:1px solid var(--border);color:var(--text);}
.btn-secondary:hover{border-color:var(--border2);}
.btn-full{width:100%;}
.btn-row{display:flex;gap:10px;}
.result-box{background:var(--bg);border:1px solid var(--border);border-radius:var(--radius-sm);padding:20px;margin-top:20px;}
.result-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
.result-item{padding:14px;background:var(--bg3);border-radius:8px;border:1px solid var(--border);}
.result-item.hl{border-color:var(--accent);background:rgba(59,130,246,0.06);}
.rl{font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);text-transform:uppercase;margin-bottom:5px;}
.rv{font-family:'Syne',sans-serif;font-weight:700;font-size:18px;word-break:break-all;}
.rv.big{font-size:26px;}
.rv.blue{color:var(--accent2);}
.rv.green{color:var(--green);}
.rv.orange{color:var(--orange);}
.rv.cyan{color:var(--cyan);}
.result-note{font-size:12px;color:var(--muted);margin-top:12px;line-height:1.6;}
input[type="range"]{-webkit-appearance:none;width:100%;height:4px;border-radius:2px;background:var(--border2);outline:none;border:none;padding:0;}
input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:18px;height:18px;border-radius:50%;
  background:var(--accent);cursor:pointer;border:3px solid var(--bg2);box-shadow:0 0 0 1px var(--accent);}
.range-row{display:flex;align-items:center;gap:12px;}
.range-val{font-family:'DM Mono',monospace;font-size:12px;color:var(--accent2);min-width:50px;text-align:right;}
.code-out{background:var(--bg);border:1px solid var(--border);border-radius:8px;padding:14px;
  font-family:'DM Mono',monospace;font-size:13px;color:var(--green);line-height:1.6;
  word-break:break-all;white-space:pre-wrap;max-height:220px;overflow-y:auto;margin-top:10px;}
.copy-btn{font-size:11px;padding:5px 12px;background:var(--bg3);border:1px solid var(--border);
  border-radius:5px;color:var(--muted);cursor:pointer;font-family:'DM Mono',monospace;transition:all 0.15s;}
.copy-btn:hover{color:var(--text);border-color:var(--border2);}
.out-hdr{display:flex;align-items:center;justify-content:space-between;margin-bottom:4px;margin-top:16px;}
.out-lbl{font-family:'DM Mono',monospace;font-size:11px;color:var(--muted);text-transform:uppercase;}
.color-preview{width:100%;height:80px;border-radius:10px;border:1px solid var(--border);margin-bottom:14px;transition:background 0.2s;}
.swatches{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:14px;}
.swatch{width:32px;height:32px;border-radius:8px;cursor:pointer;border:2px solid transparent;transition:transform 0.15s;}
.swatch:hover{transform:scale(1.15);border-color:var(--border2);}
.cvals{display:grid;grid-template-columns:1fr 1fr;gap:8px;}
.cval{background:var(--bg3);border:1px solid var(--border);border-radius:6px;padding:8px 12px;
  font-family:'DM Mono',monospace;font-size:12px;cursor:pointer;transition:border-color 0.15s;display:flex;flex-direction:column;gap:2px;}
.cval:hover{border-color:var(--border2);}
.cvl{font-size:10px;color:var(--muted);}
.inner-tabs{display:flex;gap:6px;margin-bottom:20px;}
.itab{padding:6px 16px;border-radius:6px;font-size:13px;border:1px solid var(--border);background:var(--bg3);
  color:var(--muted);cursor:pointer;transition:all 0.15s;}
.itab.active{background:rgba(59,130,246,0.12);border-color:var(--accent);color:var(--accent2);}
.toast{position:fixed;bottom:24px;right:24px;z-index:9999;background:var(--bg2);border:1px solid var(--green);
  color:var(--green);padding:10px 18px;border-radius:10px;font-size:13px;font-family:'DM Mono',monospace;
  opacity:0;transform:translateY(10px);transition:all 0.2s;pointer-events:none;}
.toast.show{opacity:1;transform:translateY(0);}
footer{position:relative;z-index:1;border-top:1px solid var(--border);padding:28px 32px;
  display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px;}
footer p{font-size:12px;color:var(--muted);}
.flinks{display:flex;gap:20px;}
.flinks a{font-size:12px;color:var(--muted);text-decoration:none;transition:color 0.15s;}
.flinks a:hover{color:var(--text);}
.hidden{display:none!important;}
::-webkit-scrollbar{width:6px;height:6px;}
::-webkit-scrollbar-track{background:var(--bg);}
::-webkit-scrollbar-thumb{background:var(--border2);border-radius:3px;}
@media(max-width:640px){
  nav{padding:0 16px;}.nav-search{display:none;}
  .hero{padding:48px 16px 36px;}.cats-wrap{padding:0 16px 20px;}
  .tools-section{padding:0 16px 60px;}.field-group{grid-template-columns:1fr;}
  .result-grid{grid-template-columns:1fr;}.modal{padding:20px;}
  footer{padding:20px 16px;}
}
</style>
</head>
<body>

<nav>
  <div class="nav-logo">‚ö° Tool<span>Vault</span> <div class="nav-badge">FREE</div></div>
  <div class="nav-search">
    <span style="color:var(--muted);font-size:14px">üîç</span>
    <input type="text" placeholder="Search tools‚Ä¶" oninput="handleSearch(this.value)"/>
  </div>
</nav>

<section class="hero">
  <h1>Every Calculator<br/><em>You'll Ever Need</em></h1>
  <p>Finance, health, dev tools, converters ‚Äî all free, all in one place.</p>
  <div class="hero-stats">
    <div><div class="stat-num">25+</div><div class="stat-label">Tools</div></div>
    <div><div class="stat-num">4</div><div class="stat-label">Categories</div></div>
    <div><div class="stat-num">‚àû</div><div class="stat-label">Free Uses</div></div>
  </div>
</section>

<div class="cats-wrap">
  <button class="cat-btn active" data-cat="all" onclick="filterCat('all',this)">‚ú¶ All Tools</button>
  <button class="cat-btn" data-cat="finance" onclick="filterCat('finance',this)">üí∞ Finance</button>
  <button class="cat-btn" data-cat="health" onclick="filterCat('health',this)">üèÉ Health</button>
  <button class="cat-btn" data-cat="dev" onclick="filterCat('dev',this)">‚å®Ô∏è Developer</button>
  <button class="cat-btn" data-cat="convert" onclick="filterCat('convert',this)">üîÑ Converters</button>
</div>

<div class="tools-section" id="toolsSection">
  <div id="hd-finance" class="section-header"><span>üí∞</span><h2>Finance</h2><span class="section-count" id="cnt-finance"></span></div>
  <div class="tools-grid" id="grid-finance"></div>
  <div id="hd-health" class="section-header"><span>üèÉ</span><h2>Health & Fitness</h2><span class="section-count" id="cnt-health"></span></div>
  <div class="tools-grid" id="grid-health"></div>
  <div id="hd-dev" class="section-header"><span>‚å®Ô∏è</span><h2>Developer Tools</h2><span class="section-count" id="cnt-dev"></span></div>
  <div class="tools-grid" id="grid-dev"></div>
  <div id="hd-convert" class="section-header"><span>üîÑ</span><h2>Converters</h2><span class="section-count" id="cnt-convert"></span></div>
  <div class="tools-grid" id="grid-convert"></div>
</div>

<div class="modal-overlay" id="modalOverlay" onclick="if(event.target===this)closeModal()">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title-wrap">
        <div class="modal-icon" id="mIcon"></div>
        <div><div class="modal-title" id="mTitle"></div><div class="modal-subtitle" id="mSub"></div></div>
      </div>
      <button class="modal-close" onclick="closeModal()">‚úï</button>
    </div>
    <div id="mBody"></div>
  </div>
</div>

<div class="toast" id="toast"></div>

<footer>
  <p>¬© 2025 ToolVault ‚Äî Built for makers, by makers. üáÆüá≥</p>
  <div class="flinks"><a href="#">Privacy</a><a href="#">About</a><a href="#">Feedback</a></div>
</footer>

<script>
const TOOLS=[
  {id:'emi',cat:'finance',color:'c-blue',icon:'üè¶',name:'EMI Calculator',desc:'Monthly loan repayment for home, car or personal loans',tag:'LOAN'},
  {id:'sip',cat:'finance',color:'c-green',icon:'üìà',name:'SIP Calculator',desc:'Project wealth from monthly SIP investments over time',tag:'INVEST'},
  {id:'gst',cat:'finance',color:'c-orange',icon:'üßæ',name:'GST Calculator',desc:'Add or remove GST ‚Äî with CGST/SGST breakdown',tag:'TAX'},
  {id:'salary',cat:'finance',color:'c-purple',icon:'üíº',name:'Salary / CTC Breakup',desc:'Break CTC into take-home, PF, HRA and tax deductions',tag:'HR'},
  {id:'fd',cat:'finance',color:'c-cyan',icon:'üèõÔ∏è',name:'FD & RD Calculator',desc:'Fixed & recurring deposit maturity with compound interest',tag:'SAVINGS'},
  {id:'ppf',cat:'finance',color:'c-green',icon:'ü™ô',name:'PPF Calculator',desc:'Public Provident Fund maturity with tax-free EEE returns',tag:'SAVINGS'},
  {id:'discount',cat:'finance',color:'c-pink',icon:'üè∑Ô∏è',name:'Discount Calculator',desc:'Final price after percentage discount ‚Äî see savings instantly',tag:'SHOPPING'},
  {id:'profit',cat:'finance',color:'c-orange',icon:'üìä',name:'Profit & Loss',desc:'Calculate profit margin, markup and revenue metrics',tag:'BUSINESS'},
  {id:'bmi',cat:'health',color:'c-green',icon:'‚öñÔ∏è',name:'BMI Calculator',desc:'Body Mass Index with healthy weight range analysis',tag:'BODY'},
  {id:'calorie',cat:'health',color:'c-orange',icon:'üî•',name:'Calorie Calculator',desc:'Daily calorie needs based on age, weight and activity level',tag:'DIET'},
  {id:'water',cat:'health',color:'c-cyan',icon:'üíß',name:'Water Intake',desc:'Daily water intake recommendation based on weight & climate',tag:'HYDRATION'},
  {id:'age',cat:'health',color:'c-blue',icon:'üéÇ',name:'Age Calculator',desc:'Exact age in years, months, days ‚Äî plus next birthday countdown',tag:'DATE'},
  {id:'sleep',cat:'health',color:'c-purple',icon:'üò¥',name:'Sleep Calculator',desc:'Best bedtimes based on 90-minute sleep cycles',tag:'SLEEP'},
  {id:'steps',cat:'health',color:'c-pink',icon:'üëü',name:'Steps to Calories',desc:'Convert daily steps to calories burned and distance walked',tag:'FITNESS'},
  {id:'base64',cat:'dev',color:'c-green',icon:'üîê',name:'Base64 Encoder',desc:'Encode and decode text in Base64 format instantly',tag:'ENCODE'},
  {id:'json',cat:'dev',color:'c-blue',icon:'üìã',name:'JSON Formatter',desc:'Prettify, validate and minify JSON with error detection',tag:'FORMAT'},
  {id:'color',cat:'dev',color:'c-pink',icon:'üé®',name:'Color Converter',desc:'Convert between HEX, RGB and HSL with click-to-copy',tag:'DESIGN'},
  {id:'regex',cat:'dev',color:'c-orange',icon:'üîç',name:'Regex Tester',desc:'Test regular expressions with real-time match highlighting',tag:'CODE'},
  {id:'lorem',cat:'dev',color:'c-cyan',icon:'üìù',name:'Lorem Ipsum',desc:'Generate placeholder text for designs and prototypes',tag:'TEXT'},
  {id:'timestamp',cat:'dev',color:'c-purple',icon:'‚è±Ô∏è',name:'Unix Timestamp',desc:'Convert between Unix timestamps and human-readable dates',tag:'DATE'},
  {id:'numbase',cat:'dev',color:'c-blue',icon:'üî¢',name:'Number Base',desc:'Convert between binary, octal, decimal and hexadecimal',tag:'CODE'},
  {id:'length',cat:'convert',color:'c-blue',icon:'üìè',name:'Length Converter',desc:'Convert km, miles, meters, feet, inches and more',tag:'LENGTH'},
  {id:'weight',cat:'convert',color:'c-green',icon:'üèãÔ∏è',name:'Weight Converter',desc:'Convert kg, lbs, grams, ounces and stones',tag:'WEIGHT'},
  {id:'temp',cat:'convert',color:'c-orange',icon:'üå°Ô∏è',name:'Temperature',desc:'Convert Celsius, Fahrenheit and Kelvin instantly',tag:'TEMP'},
  {id:'speed',cat:'convert',color:'c-purple',icon:'üöÄ',name:'Speed Converter',desc:'Convert km/h, mph, m/s, knots and Mach speed',tag:'SPEED'},
  {id:'area',cat:'convert',color:'c-cyan',icon:'‚¨ú',name:'Area Converter',desc:'Convert sqm, sqft, acres, hectares and bigha',tag:'AREA'},
];

function renderTools(list){
  ['finance','health','dev','convert'].forEach(cat=>{
    const tools=(list||TOOLS).filter(t=>t.cat===cat);
    const g=document.getElementById('grid-'+cat);
    const h=document.getElementById('hd-'+cat);
    const c=document.getElementById('cnt-'+cat);
    c.textContent=tools.length+' tools';
    h.style.display=tools.length?'':'none';
    g.innerHTML=tools.map(t=>`
      <div class="tool-card ${t.color}" onclick="openTool('${t.id}')">
        <div class="tool-icon-wrap">${t.icon}</div>
        <div class="tool-name">${t.name}</div>
        <div class="tool-desc">${t.desc}</div>
        <span class="tool-tag">${t.tag}</span>
      </div>`).join('');
  });
}
renderTools();

function filterCat(cat,btn){
  document.querySelectorAll('.cat-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  ['finance','health','dev','convert'].forEach(c=>{
    const show=cat==='all'||cat===c;
    document.getElementById('hd-'+c).style.display=show?'':'none';
    document.getElementById('grid-'+c).style.display=show?'':'none';
  });
}

function handleSearch(q){
  q=q.trim().toLowerCase();
  if(!q){renderTools();return;}
  const res=TOOLS.filter(t=>t.name.toLowerCase().includes(q)||t.desc.toLowerCase().includes(q)||t.tag.toLowerCase().includes(q)||t.cat.includes(q));
  renderTools(res);
  ['finance','health','dev','convert'].forEach(c=>{
    document.getElementById('hd-'+c).style.display='';
    document.getElementById('grid-'+c).style.display='';
  });
}

const iconBg={'c-blue':'rgba(59,130,246,0.12)','c-green':'rgba(16,185,129,0.12)','c-orange':'rgba(245,158,11,0.12)','c-pink':'rgba(236,72,153,0.12)','c-purple':'rgba(139,92,246,0.12)','c-cyan':'rgba(6,182,212,0.12)'};

function openTool(id){
  const t=TOOLS.find(x=>x.id===id); if(!t)return;
  document.getElementById('mIcon').style.background=iconBg[t.color];
  document.getElementById('mIcon').textContent=t.icon;
  document.getElementById('mTitle').textContent=t.name;
  document.getElementById('mSub').textContent=t.desc;
  document.getElementById('mBody').innerHTML=getHTML(id);
  document.getElementById('modalOverlay').classList.add('open');
  document.body.style.overflow='hidden';
  if(id==='color')setTimeout(initColor,50);
  if(id==='timestamp')setTimeout(()=>{const n=Math.floor(Date.now()/1000);document.getElementById('tsIn').value=n;},50);
}
function closeModal(){
  document.getElementById('modalOverlay').classList.remove('open');
  document.body.style.overflow='';
}
document.addEventListener('keydown',e=>{if(e.key==='Escape')closeModal();});

const fmt=(n,d=2)=>typeof n==='number'?n.toLocaleString('en-IN',{maximumFractionDigits:d}):n;
const fmtCr=n=>n>=10000000?'‚Çπ'+fmt(n/10000000,2)+' Cr':n>=100000?'‚Çπ'+fmt(n/100000,2)+' L':'‚Çπ'+fmt(n,0);
const rg=(items,note='')=>`<div class="result-box"><div class="result-grid">${items.map(([l,v,hl,big])=>`<div class="result-item ${hl?'hl':''}"><div class="rl">${l}</div><div class="rv ${big?'big blue':''}">${v}</div></div>`).join('')}</div>${note?`<div class="result-note">${note}</div>`:''}</div>`;

function getHTML(id){
  const RNG=(id,min,max,val,label,unit)=>`
    <div class="field full"><label>${label} ‚Äî <span id="${id}L">${val} ${unit}</span></label>
    <div class="range-row"><input type="range" id="${id}" min="${min}" max="${max}" value="${val}" oninput="document.getElementById('${id}L').textContent=this.value+' ${unit}'"/>
    </div></div>`;
  switch(id){
    case 'emi':return`
      <div class="field-group">
        <div class="field"><label>Principal (‚Çπ)</label><input type="number" id="eP" value="1000000" min="1"/></div>
        <div class="field"><label>Annual Rate (%)</label><input type="number" id="eR" value="8.5" step="0.1" min="0.1"/></div>
        ${RNG('eT',1,30,20,'Loan Tenure','Years')}
      </div>
      <button class="btn btn-primary btn-full" onclick="calcEMI()">Calculate EMI</button>
      <div id="eRes"></div>`;

    case 'sip':return`
      <div class="field-group">
        <div class="field"><label>Monthly SIP (‚Çπ)</label><input type="number" id="sA" value="5000" min="100"/></div>
        <div class="field"><label>Expected Return (%)</label><input type="number" id="sR" value="12" step="0.5"/></div>
        ${RNG('sT',1,40,10,'Period','Years')}
      </div>
      <button class="btn btn-primary btn-full" onclick="calcSIP()">Calculate Returns</button>
      <div id="sRes"></div>`;

    case 'gst':return`
      <div class="inner-tabs">
        <button class="itab active" id="gT1" onclick="gMode='add';switchTabs('gT1','gT2')">Add GST</button>
        <button class="itab" id="gT2" onclick="gMode='remove';switchTabs('gT2','gT1')">Remove GST</button>
      </div>
      <div class="field-group">
        <div class="field"><label>Amount (‚Çπ)</label><input type="number" id="gA" value="1000"/></div>
        <div class="field"><label>GST Rate</label>
          <select id="gR"><option value="5">5%</option><option value="12">12%</option><option value="18" selected>18%</option><option value="28">28%</option><option value="3">3%</option></select></div>
      </div>
      <button class="btn btn-primary btn-full" onclick="calcGST()">Calculate</button>
      <div id="gRes"></div>`;

    case 'salary':return`
      <div class="field-group">
        <div class="field"><label>Annual CTC (‚Çπ)</label><input type="number" id="cA" value="1200000"/></div>
        <div class="field"><label>Basic % of CTC</label><input type="number" id="cB" value="40" min="30" max="60"/></div>
        <div class="field"><label>City Type</label>
          <select id="cC"><option value="0.5">Metro (HRA 50%)</option><option value="0.4">Non-Metro (40%)</option></select></div>
        <div class="field"><label>Other Deductions/mo (‚Çπ)</label><input type="number" id="cD" value="0"/></div>
      </div>
      <button class="btn btn-primary btn-full" onclick="calcSalary()">Generate Breakup</button>
      <div id="cRes"></div>`;

    case 'fd':return`
      <div class="inner-tabs">
        <button class="itab active" id="fT1" onclick="fdMode='fd';switchTabs('fT1','fT2')">Fixed Deposit</button>
        <button class="itab" id="fT2" onclick="fdMode='rd';switchTabs('fT2','fT1')">Recurring Deposit</button>
      </div>
      <div class="field-group">
        <div class="field"><label>Amount (‚Çπ)</label><input type="number" id="fP" value="100000"/></div>
        <div class="field"><label>Rate (% p.a.)</label><input type="number" id="fR" value="7" step="0.1"/></div>
        <div class="field"><label>Tenure (Years)</label><input type="number" id="fT" value="5" min="1" max="30"/></div>
        <div class="field"><label>Compounding</label>
          <select id="fC"><option value="1">Annually</option><option value="2">Half-yearly</option><option value="4" selected>Quarterly</option><option value="12">Monthly</option></select></div>
      </div>
      <button class="btn btn-primary btn-full" onclick="calcFD()">Calculate Maturity</button>
      <div id="fRes"></div>`;

    case 'ppf':return`
      <div class="field-group">
        <div class="field"><label>Yearly Deposit (‚Çπ)</label><input type="number" id="pA" value="150000" min="500" max="150000"/></div>
        <div class="field"><label>Rate (% p.a.)</label><input type="number" id="pR" value="7.1" step="0.1"/></div>
        ${RNG('pT',15,50,15,'Duration','Years')}
      </div>
      <button class="btn btn-primary btn-full" onclick="calcPPF()">Calculate</button>
      <div id="pRes"></div>`;

    case 'discount':return`
      <div class="field-group">
        <div class="field"><label>Original Price (‚Çπ)</label><input type="number" id="dP" value="2000"/></div>
        <div class="field"><label>Discount (%)</label><input type="number" id="dD" value="30" min="0" max="100"/></div>
      </div>
      <button class="btn btn-primary btn-full" onclick="calcDiscount()">Calculate Savings</button>
      <div id="dRes"></div>`;

    case 'profit':return`
      <div class="field-group">
        <div class="field"><label>Cost Price (‚Çπ)</label><input type="number" id="prC" value="800"/></div>
        <div class="field"><label>Selling Price (‚Çπ)</label><input type="number" id="prS" value="1200"/></div>
      </div>
      <button class="btn btn-primary btn-full" onclick="calcProfit()">Calculate</button>
      <div id="prRes"></div>`;

    case 'bmi':return`
      <div class="field-group">
        <div class="field"><label>Weight (kg)</label><input type="number" id="bW" value="70"/></div>
        <div class="field"><label>Height (cm)</label><input type="number" id="bH" value="170"/></div>
        <div class="field"><label>Age</label><input type="number" id="bAge" value="25"/></div>
        <div class="field"><label>Gender</label><select id="bG"><option>Male</option><option>Female</option></select></div>
      </div>
      <button class="btn btn-primary btn-full" onclick="calcBMI()">Calculate BMI</button>
      <div id="bRes"></div>`;

    case 'calorie':return`
      <div class="field-group">
        <div class="field"><label>Weight (kg)</label><input type="number" id="clW" value="70"/></div>
        <div class="field"><label>Height (cm)</label><input type="number" id="clH" value="170"/></div>
        <div class="field"><label>Age</label><input type="number" id="clA" value="25"/></div>
        <div class="field"><label>Gender</label><select id="clG"><option>Male</option><option>Female</option></select></div>
        <div class="field full"><label>Activity Level</label>
          <select id="clAct">
            <option value="1.2">Sedentary (desk job)</option>
            <option value="1.375" selected>Lightly active (1‚Äì3 days/wk)</option>
            <option value="1.55">Moderately active (3‚Äì5 days)</option>
            <option value="1.725">Very active (6‚Äì7 days)</option>
            <option value="1.9">Extremely active (athlete)</option>
          </select></div>
      </div>
      <button class="btn btn-primary btn-full" onclick="calcCalorie()">Calculate Calories</button>
      <div id="clRes"></div>`;

    case 'water':return`
      <div class="field-group">
        <div class="field"><label>Weight (kg)</label><input type="number" id="wW" value="70"/></div>
        <div class="field"><label>Activity</label>
          <select id="wA"><option value="0">Low</option><option value="1" selected>Moderate</option><option value="2">High / Athlete</option></select></div>
        <div class="field full"><label>Climate</label>
          <select id="wCl"><option value="0">Cool</option><option value="1" selected>Warm (India avg)</option><option value="2">Hot & Humid</option></select></div>
      </div>
      <button class="btn btn-primary btn-full" onclick="calcWater()">Calculate</button>
      <div id="wRes"></div>`;

    case 'age':return`
      <div class="field"><label>Date of Birth (DD/MM/YYYY)</label>
        <input type="text" id="aD" placeholder="e.g. 15/08/1995" value="01/01/1995"/></div>
      <button class="btn btn-primary btn-full" onclick="calcAge()">Calculate Age</button>
      <div id="aRes"></div>`;

    case 'sleep':return`
      <div class="field"><label>Desired Wake-Up Time (HH:MM)</label>
        <input type="text" id="slW" placeholder="e.g. 07:00" value="07:00"/></div>
      <button class="btn btn-primary btn-full" onclick="calcSleep()">Find Bedtimes</button>
      <div id="slRes"></div>`;

    case 'steps':return`
      <div class="field-group">
        <div class="field"><label>Steps Today</label><input type="number" id="stN" value="8000"/></div>
        <div class="field"><label>Weight (kg)</label><input type="number" id="stW" value="70"/></div>
        <div class="field"><label>Height (cm)</label><input type="number" id="stH" value="170"/></div>
        <div class="field"><label>Pace</label>
          <select id="stP"><option value="slow">Slow stroll</option><option value="normal" selected>Normal walk</option><option value="brisk">Brisk walk</option><option value="run">Running</option></select></div>
      </div>
      <button class="btn btn-primary btn-full" onclick="calcSteps()">Calculate</button>
      <div id="stRes"></div>`;

    case 'base64':return`
      <div class="inner-tabs">
        <button class="itab active" id="b1" onclick="b64Mode='encode';switchTabs('b1','b2');document.getElementById('b64Lbl').textContent='Input Text'">Encode</button>
        <button class="itab" id="b2" onclick="b64Mode='decode';switchTabs('b2','b1');document.getElementById('b64Lbl').textContent='Base64 String'">Decode</button>
      </div>
      <div class="field"><label id="b64Lbl">Input Text</label>
        <textarea id="b64In" placeholder="Enter text to encode‚Ä¶"></textarea></div>
      <button class="btn btn-primary btn-full" onclick="doBase64()">Convert</button>
      <div class="out-hdr"><span class="out-lbl">Output</span><button class="copy-btn" onclick="copyEl('b64Out')">Copy</button></div>
      <div class="code-out" id="b64Out">‚Äî</div>`;

    case 'json':return`
      <div class="field"><label>Paste JSON</label>
        <textarea id="jsonIn" style="min-height:130px" placeholder='{"name":"ToolVault","version":1}'></textarea></div>
      <div class="btn-row">
        <button class="btn btn-primary" onclick="fmtJSON()">Format / Validate</button>
        <button class="btn btn-secondary" onclick="minJSON()">Minify</button>
      </div>
      <div class="out-hdr"><span class="out-lbl" id="jsonSt">Output</span><button class="copy-btn" onclick="copyEl('jsonOut')">Copy</button></div>
      <div class="code-out" id="jsonOut">‚Äî</div>`;

    case 'color':return`
      <div class="color-preview" id="cpv" style="background:#3B82F6"></div>
      <div class="field"><label>HEX Color Code</label>
        <input type="text" id="cHex" value="#3B82F6" placeholder="#RRGGBB" oninput="hexChanged(this.value)"/></div>
      <div class="swatches" id="swatches"></div>
      <div class="cvals" id="cvals"></div>`;

    case 'regex':return`
      <div class="field"><label>Regular Expression Pattern</label>
        <input type="text" id="rxP" value="[A-Z][a-z]+" placeholder="Enter regex‚Ä¶"/></div>
      <div class="field"><label>Test String</label>
        <textarea id="rxS" style="min-height:90px">Hello World. Testing Regex. ToolVault Rocks.</textarea></div>
      <button class="btn btn-primary btn-full" onclick="doRegex()">Test</button>
      <div id="rxRes"></div>`;

    case 'lorem':return`
      <div class="field-group">
        <div class="field"><label>Paragraphs</label><input type="number" id="lrP" value="2" min="1" max="10"/></div>
        <div class="field"><label>Type</label><select id="lrT"><option value="classic">Classic Lorem</option><option value="tech">Tech Ipsum</option></select></div>
      </div>
      <button class="btn btn-primary btn-full" onclick="doLorem()">Generate Text</button>
      <div class="out-hdr" style="margin-top:14px"><span class="out-lbl">Output</span><button class="copy-btn" onclick="copyEl('lrOut')">Copy</button></div>
      <div class="code-out" id="lrOut" style="color:var(--muted)">‚Äî</div>`;

    case 'timestamp':return`
      <div class="inner-tabs">
        <button class="itab active" id="ts1" onclick="tsMode='tod';switchTabs('ts1','ts2');document.getElementById('tsInWrap').classList.remove('hidden');document.getElementById('tsDtWrap').classList.add('hidden')">Unix ‚Üí Date</button>
        <button class="itab" id="ts2" onclick="tsMode='tod2';switchTabs('ts2','ts1');document.getElementById('tsDtWrap').classList.remove('hidden');document.getElementById('tsInWrap').classList.add('hidden')">Date ‚Üí Unix</button>
      </div>
      <div id="tsInWrap"><div class="field"><label>Unix Timestamp (seconds)</label><input type="number" id="tsIn" placeholder="e.g. 1700000000"/></div>
      <button class="btn btn-primary btn-full" onclick="convTS()">Convert to Date</button></div>
      <div id="tsDtWrap" class="hidden"><div class="field"><label>Date & Time (YYYY-MM-DD HH:MM:SS)</label><input type="text" id="tsDt" placeholder="2025-01-15 14:30:00"/></div>
      <button class="btn btn-primary btn-full" onclick="convDT()">Convert to Unix</button></div>
      <div id="tsRes"></div>`;

    case 'numbase':return`
      <div class="field"><label>Input Number</label><input type="text" id="nbIn" value="255" placeholder="Enter number‚Ä¶"/></div>
      <div class="field"><label>Input Base</label>
        <select id="nbFr"><option value="10" selected>Decimal (Base 10)</option><option value="2">Binary (Base 2)</option><option value="8">Octal (Base 8)</option><option value="16">Hexadecimal (Base 16)</option></select></div>
      <button class="btn btn-primary btn-full" onclick="calcNB()">Convert All Bases</button>
      <div id="nbRes"></div>`;

    case 'length':return`
      <div class="field-group">
        <div class="field"><label>Value</label><input type="number" id="lnV" value="1" step="any" min="0"/></div>
        <div class="field"><label>From Unit</label>
          <select id="lnF"><option value="km">Kilometer</option><option value="m" selected>Meter</option><option value="cm">Centimeter</option><option value="mm">Millimeter</option><option value="mi">Mile</option><option value="ft">Foot</option><option value="in">Inch</option><option value="yd">Yard</option></select></div>
      </div>
      <button class="btn btn-primary btn-full" onclick="calcLen()">Convert All</button>
      <div id="lnRes"></div>`;

    case 'weight':return`
      <div class="field-group">
        <div class="field"><label>Value</label><input type="number" id="wtV" value="1" step="any" min="0"/></div>
        <div class="field"><label>From Unit</label>
          <select id="wtF"><option value="kg" selected>Kilogram</option><option value="g">Gram</option><option value="mg">Milligram</option><option value="lb">Pound</option><option value="oz">Ounce</option><option value="t">Metric Ton</option></select></div>
      </div>
      <button class="btn btn-primary btn-full" onclick="calcWt()">Convert All</button>
      <div id="wtRes"></div>`;

    case 'temp':return`
      <div class="field-group">
        <div class="field"><label>Temperature Value</label><input type="number" id="tpV" value="100" step="any"/></div>
        <div class="field"><label>From Unit</label>
          <select id="tpF"><option value="c" selected>Celsius (¬∞C)</option><option value="f">Fahrenheit (¬∞F)</option><option value="k">Kelvin (K)</option></select></div>
      </div>
      <button class="btn btn-primary btn-full" onclick="calcTemp()">Convert</button>
      <div id="tpRes"></div>`;

    case 'speed':return`
      <div class="field-group">
        <div class="field"><label>Speed Value</label><input type="number" id="spV" value="100" step="any" min="0"/></div>
        <div class="field"><label>From Unit</label>
          <select id="spF"><option value="kmh" selected>km/h</option><option value="ms">m/s</option><option value="mph">mph</option><option value="kt">Knots</option><option value="mach">Mach</option></select></div>
      </div>
      <button class="btn btn-primary btn-full" onclick="calcSpd()">Convert All</button>
      <div id="spRes"></div>`;

    case 'area':return`
      <div class="field-group">
        <div class="field"><label>Area Value</label><input type="number" id="arV" value="1" step="any" min="0"/></div>
        <div class="field"><label>From Unit</label>
          <select id="arF"><option value="sqm" selected>sq. meter</option><option value="sqkm">sq. km</option><option value="sqft">sq. feet</option><option value="acre">Acre</option><option value="ha">Hectare</option><option value="bigha">Bigha (India)</option></select></div>
      </div>
      <button class="btn btn-primary btn-full" onclick="calcArea()">Convert All</button>
      <div id="arRes"></div>`;

    default:return'<p style="color:var(--muted)">Coming soon!</p>';
  }
}

// ‚îÄ‚îÄ TAB HELPER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let gMode='add',fdMode='fd',b64Mode='encode',tsMode='tod';
function switchTabs(a,b){
  document.getElementById(a).classList.add('active');
  document.getElementById(b).classList.remove('active');
}

// ‚îÄ‚îÄ CALC FUNCTIONS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

window.calcEMI=()=>{
  const P=+document.getElementById('eP').value,r=+document.getElementById('eR').value/12/100,n=+document.getElementById('eT').value*12;
  const emi=P*r*Math.pow(1+r,n)/(Math.pow(1+r,n)-1);
  const total=emi*n,interest=total-P;
  document.getElementById('eRes').innerHTML=rg([
    ['Monthly EMI','‚Çπ'+fmt(emi,0),true,true],
    ['Total Interest','‚Çπ'+fmt(interest,0)],
    ['Total Payment','‚Çπ'+fmt(total,0)],
    ['Principal','‚Çπ'+fmt(P,0)],
  ])+`<div class="result-note" style="margin-top:12px">
    <div style="display:flex;gap:10px;font-size:12px;margin-bottom:6px">
      <span style="color:var(--accent2)">‚ñÆ Principal ${Math.round(P/total*100)}%</span>
      <span style="color:var(--orange)">‚ñÆ Interest ${Math.round(interest/total*100)}%</span>
    </div>
    <div style="display:flex;height:8px;border-radius:4px;overflow:hidden">
      <div style="width:${P/total*100}%;background:var(--accent)"></div>
      <div style="flex:1;background:var(--orange)"></div>
    </div></div>`;
};

window.calcSIP=()=>{
  const P=+document.getElementById('sA').value,r=+document.getElementById('sR').value/12/100,n=+document.getElementById('sT').value*12;
  const mat=P*((Math.pow(1+r,n)-1)/r)*(1+r),inv=P*n,gain=mat-inv;
  document.getElementById('sRes').innerHTML=rg([
    ['Maturity Value',fmtCr(mat),true,true],
    ['Wealth Gained',fmtCr(gain)],
    ['Total Invested',fmtCr(inv)],
    ['Absolute Return',fmt(gain/inv*100,1)+'%'],
  ],'üí° SIP returns assume constant rate ‚Äî actual market returns vary.');
};

window.calcGST=()=>{
  const amt=+document.getElementById('gA').value,rate=+document.getElementById('gR').value;
  let pre,gstAmt,post;
  if(gMode==='add'){pre=amt;gstAmt=amt*rate/100;post=amt+gstAmt;}
  else{post=amt;pre=amt*100/(100+rate);gstAmt=post-pre;}
  document.getElementById('gRes').innerHTML=rg([
    ['Pre-GST Amount','‚Çπ'+fmt(pre,2)],
    ['GST ('+rate+'%)','‚Çπ'+fmt(gstAmt,2),true],
    ['CGST ('+rate/2+'%)','‚Çπ'+fmt(gstAmt/2,2)],
    ['SGST ('+rate/2+'%)','‚Çπ'+fmt(gstAmt/2,2)],
    ['Final Amount','‚Çπ'+fmt(post,2),false,true],
  ]);
};

window.calcSalary=()=>{
  const ctc=+document.getElementById('cA').value,bpct=+document.getElementById('cB').value/100;
  const hraPct=+document.getElementById('cC').value,extraD=+document.getElementById('cD').value;
  const mCtc=ctc/12,basic=mCtc*bpct,hra=basic*hraPct,spec=mCtc-basic-hra-1800;
  const pfEmp=Math.min(basic*0.12,1800);
  const ti=ctc-200000;
  const tax=ti>1500000?(ti-1500000)*0.3+187500:ti>1200000?(ti-1200000)*0.2+127500:ti>900000?(ti-900000)*0.15+52500:ti>600000?(ti-600000)*0.1+15000:ti>300000?(ti-300000)*0.05:0;
  const takeHome=mCtc-pfEmp-Math.max(0,tax/12)-extraD;
  document.getElementById('cRes').innerHTML=rg([
    ['Take-Home / Month','‚Çπ'+fmt(takeHome,0),true,true],
    ['Gross / Month','‚Çπ'+fmt(mCtc,0)],
    ['Basic / Month','‚Çπ'+fmt(basic,0)],
    ['HRA / Month','‚Çπ'+fmt(hra,0)],
    ['PF Deduction','‚Çπ'+fmt(pfEmp,0)],
    ['Est. Tax/Month','‚Çπ'+fmt(Math.max(0,tax/12),0)],
  ],'‚ö† Approximate calculation. Actual tax depends on investments and regime.');
};

window.calcFD=()=>{
  const P=+document.getElementById('fP').value,r=+document.getElementById('fR').value/100;
  const t=+document.getElementById('fT').value,n=+document.getElementById('fC').value;
  let mat,interest;
  if(fdMode==='fd'){mat=P*Math.pow(1+r/n,n*t);interest=mat-P;}
  else{const rn=r/12,mo=t*12;mat=P*(Math.pow(1+rn,mo)-1)*(1+rn)/rn;interest=mat-P*mo;}
  document.getElementById('fRes').innerHTML=rg([
    ['Maturity Amount',fmtCr(mat),true,true],
    ['Interest Earned',fmtCr(interest)],
    ['Principal',fmtCr(fdMode==='fd'?P:P*t*12)],
    ['Effective Yield',fmt((mat/(fdMode==='fd'?P:P*t*12)-1)*100/t,2)+'% p.a.'],
  ]);
};

window.calcPPF=()=>{
  const y=+document.getElementById('pA').value,r=+document.getElementById('pR').value/100,yrs=+document.getElementById('pT').value;
  let bal=0;for(let i=0;i<yrs;i++)bal=(bal+y)*(1+r);
  const inv=y*yrs;
  document.getElementById('pRes').innerHTML=rg([
    ['Maturity Amount',fmtCr(bal),true,true],
    ['Interest Earned',fmtCr(bal-inv)],
    ['Total Invested',fmtCr(inv)],
    ['Tax Status','EEE (Fully Exempt)'],
  ],'PPF is one of the best risk-free instruments. Max ‚Çπ1.5L/year allowed.');
};

window.calcDiscount=()=>{
  const p=+document.getElementById('dP').value,d=+document.getElementById('dD').value;
  const disc=p*d/100,final=p-disc;
  document.getElementById('dRes').innerHTML=rg([
    ['Final Price','‚Çπ'+fmt(final,2),true,true],
    ['You Save','‚Çπ'+fmt(disc,2)+' ('+d+'%)'],
  ]);
};

window.calcProfit=()=>{
  const cp=+document.getElementById('prC').value,sp=+document.getElementById('prS').value;
  const pl=sp-cp,gain=pl>=0;
  document.getElementById('prRes').innerHTML=rg([
    [gain?'Profit':'Loss','‚Çπ'+fmt(Math.abs(pl),2),true,true],
    [gain?'Profit %':'Loss %',fmt(Math.abs(pl/cp*100),2)+'%'],
    ['Markup %',fmt((sp/cp-1)*100,2)+'%'],
    ['Gross Margin',fmt(pl/sp*100,2)+'%'],
  ]);
};

window.calcBMI=()=>{
  const w=+document.getElementById('bW').value,h=+document.getElementById('bH').value/100;
  const bmi=w/(h*h);
  const cat=bmi<18.5?'‚¨á Underweight':bmi<25?'‚úì Normal':bmi<30?'‚Üë Overweight':'‚ö† Obese';
  const minW=fmt(18.5*h*h,1),maxW=fmt(24.9*h*h,1);
  document.getElementById('bRes').innerHTML=rg([
    ['Your BMI',fmt(bmi,1),true,true],
    ['Category',cat],
    ['Healthy Weight',minW+'‚Äì'+maxW+' kg'],
    ['Ideal Weight',fmt((18.5+24.9)/2*h*h,1)+' kg'],
  ],'BMI: <18.5 Underweight | 18.5‚Äì24.9 Normal | 25‚Äì29.9 Overweight | ‚â•30 Obese');
};

window.calcCalorie=()=>{
  const w=+document.getElementById('clW').value,h=+document.getElementById('clH').value;
  const age=+document.getElementById('clA').value,isMale=document.getElementById('clG').value==='Male';
  const act=+document.getElementById('clAct').value;
  const bmr=isMale?10*w+6.25*h-5*age+5:10*w+6.25*h-5*age-161;
  const tdee=bmr*act;
  document.getElementById('clRes').innerHTML=rg([
    ['Maintenance',fmt(tdee,0)+' kcal',true,true],
    ['Basal BMR',fmt(bmr,0)+' kcal'],
    ['Weight Loss',fmt(tdee-500,0)+' kcal'],
    ['Weight Gain',fmt(tdee+500,0)+' kcal'],
  ],'Reduce 500 kcal/day = lose ~0.5 kg/week. Increase 500 kcal/day to gain.');
};

window.calcWater=()=>{
  const w=+document.getElementById('wW').value,act=+document.getElementById('wA').value,cl=+document.getElementById('wCl').value;
  const liters=w*0.033+act*0.5+cl*0.3;
  const glasses=Math.round(liters*1000/240);
  document.getElementById('wRes').innerHTML=rg([
    ['Daily Intake',fmt(liters,1)+' Litres',true,true],
    ['In Glasses (~240ml)',glasses+' glasses'],
    ['In mL',fmt(liters*1000,0)+' mL'],
    ['Spread Per Hour',fmt(liters/16,2)+' L (16 waking hrs)'],
  ],'Drink an extra 200‚Äì300 mL per 30 min of exercise. More if it\'s very hot.');
};

window.calcAge=()=>{
  const p=document.getElementById('aD').value.split('/');
  if(p.length!==3){alert('Use DD/MM/YYYY');return;}
  const dob=new Date(+p[2],+p[1]-1,+p[0]),now=new Date();
  let y=now.getFullYear()-dob.getFullYear(),m=now.getMonth()-dob.getMonth(),d=now.getDate()-dob.getDate();
  if(d<0){m--;d+=new Date(now.getFullYear(),now.getMonth(),0).getDate();}
  if(m<0){y--;m+=12;}
  const days=Math.floor((now-dob)/86400000);
  const next=new Date(dob);next.setFullYear(now.getFullYear());
  if(next<=now)next.setFullYear(now.getFullYear()+1);
  const dbn=Math.ceil((next-now)/86400000);
  document.getElementById('aRes').innerHTML=rg([
    ['Age',y+' yrs, '+m+' mo',true,true],
    ['In Days',fmt(days,0)+' days'],
    ['Next Birthday','in '+dbn+' days'],
    ['Born On',dob.toLocaleDateString('en-IN',{weekday:'long'})],
  ]);
};

window.calcSleep=()=>{
  const t=document.getElementById('slW').value,[h,m]=t.split(':').map(Number);
  if(isNaN(h)||isNaN(m)){alert('Use HH:MM');return;}
  const times=[];
  for(let c=1;c<=6;c++){
    let bm=(h*60+m)-(c*90)-14;while(bm<0)bm+=1440;
    times.push({c,t:`${String(Math.floor(bm/60)%24).padStart(2,'0')}:${String(bm%60).padStart(2,'0')}`});
  }
  const best=times.slice(-3).reverse();
  document.getElementById('slRes').innerHTML=`<div class="result-box">
    <div class="rl" style="margin-bottom:12px">Recommended bedtimes to wake at ${t}</div>
    ${best.map((x,i)=>`<div style="display:flex;align-items:center;justify-content:space-between;padding:12px 14px;background:var(--bg3);border-radius:8px;margin-bottom:8px;border:1px solid ${i===0?'var(--accent)':'var(--border)'}">
      <span style="font-size:12px;color:var(--muted);font-family:'DM Mono',monospace">${x.c} cycles = ${x.c*1.5}h sleep</span>
      <span style="font-family:'Syne',sans-serif;font-weight:700;font-size:20px;color:${i===0?'var(--accent2)':'var(--text)'}">${x.t}</span>
    </div>`).join('')}
    <div class="result-note">üí° The top option gives you 6 complete sleep cycles (9h). 5 cycles (7.5h) is also great.</div>
  </div>`;
};

window.calcSteps=()=>{
  const n=+document.getElementById('stN').value,w=+document.getElementById('stW').value,h=+document.getElementById('stH').value;
  const pace=document.getElementById('stP').value;
  const stride={slow:0.6,normal:0.72,brisk:0.8,run:1.1}[pace]*h/170;
  const met={slow:2.5,normal:3.5,brisk:4.5,run:8.0}[pace];
  const dist=n*stride/1000,hrs=dist/({slow:4,normal:5,brisk:6,run:10}[pace]),cals=met*w*hrs;
  document.getElementById('stRes').innerHTML=rg([
    ['Distance',fmt(dist,2)+' km',true,true],
    ['Calories Burned',fmt(cals,0)+' kcal'],
    ['Active Time',fmt(hrs*60,0)+' minutes'],
    ['Goal Progress',Math.round(n/10000*100)+'% of 10K goal'],
  ]);
};

window.doBase64=()=>{
  const txt=document.getElementById('b64In').value;
  try{document.getElementById('b64Out').textContent=b64Mode==='encode'?btoa(unescape(encodeURIComponent(txt))):decodeURIComponent(escape(atob(txt)));}
  catch(e){document.getElementById('b64Out').textContent='‚ö† Invalid input for '+b64Mode;}
};

window.fmtJSON=()=>{
  try{document.getElementById('jsonOut').textContent=JSON.stringify(JSON.parse(document.getElementById('jsonIn').value),null,2);document.getElementById('jsonSt').textContent='‚úì Valid JSON';document.getElementById('jsonSt').style.color='var(--green)';}
  catch(e){document.getElementById('jsonOut').textContent='‚ö† '+e.message;document.getElementById('jsonSt').textContent='‚úó Invalid JSON';document.getElementById('jsonSt').style.color='var(--red)';}
};
window.minJSON=()=>{try{document.getElementById('jsonOut').textContent=JSON.stringify(JSON.parse(document.getElementById('jsonIn').value));}catch(e){document.getElementById('jsonOut').textContent='‚ö† '+e.message;}};

function hexToRgb(h){return{r:parseInt(h.slice(1,3),16),g:parseInt(h.slice(3,5),16),b:parseInt(h.slice(5,7),16)};}
function rgbToHsl(r,g,b){r/=255;g/=255;b/=255;const mx=Math.max(r,g,b),mn=Math.min(r,g,b);let h,s,l=(mx+mn)/2;
  if(mx===mn){h=s=0;}else{const d=mx-mn;s=l>0.5?d/(2-mx-mn):d/(mx+mn);switch(mx){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break;}h/=6;}
  return{h:Math.round(h*360),s:Math.round(s*100),l:Math.round(l*100)};}
window.hexChanged=h=>{
  if(!/^#[0-9A-Fa-f]{6}$/.test(h))return;
  document.getElementById('cpv').style.background=h;
  const{r,g,b}=hexToRgb(h),{h:hh,s,l}=rgbToHsl(r,g,b);
  document.getElementById('cvals').innerHTML=[
    ['HEX',h],['RGB',`rgb(${r},${g},${b})`],['HSL',`hsl(${hh},${s}%,${l}%)`],['RGBA',`rgba(${r},${g},${b},1)`]
  ].map(([lbl,val])=>`<div class="cval" onclick="copyRaw('${val}')"><span class="cvl">${lbl}</span><span>${val}</span></div>`).join('');
};
window.copyRaw=txt=>navigator.clipboard.writeText(txt).then(()=>showToast('Copied: '+txt));
function initColor(){
  const cols=['#3B82F6','#10B981','#F59E0B','#EC4899','#8B5CF6','#06B6D4','#EF4444','#F97316','#84CC16','#14B8A6'];
  document.getElementById('swatches').innerHTML=cols.map(c=>`<div class="swatch" style="background:${c}" onclick="document.getElementById('cHex').value='${c}';hexChanged('${c}')"></div>`).join('');
  hexChanged('#3B82F6');
}

window.doRegex=()=>{
  try{
    const rx=new RegExp(document.getElementById('rxP').value,'g'),str=document.getElementById('rxS').value;
    const matches=[...str.matchAll(rx)];
    const hl=str.replace(rx,m=>`<mark style="background:rgba(245,158,11,0.25);color:var(--orange);border-radius:3px;padding:0 2px">${m}</mark>`);
    document.getElementById('rxRes').innerHTML=`<div class="result-box">
      <div class="rl" style="margin-bottom:8px">Matches: <span style="color:var(--green)">${matches.length} found</span></div>
      <div style="font-size:13px;line-height:1.9;word-break:break-all">${hl||'<span style="color:var(--muted)">No matches</span>'}</div>
      ${matches.length?'<div style="margin-top:10px">'+matches.map((m,i)=>`<div style="font-size:12px;color:var(--orange);font-family:'DM Mono',monospace;margin-top:3px">[${i}] "${m[0]}" at index ${m.index}</div>`).join('')+'</div>':''}
    </div>`;
  }catch(e){document.getElementById('rxRes').innerHTML=`<div class="result-box"><span style="color:var(--red)">‚ö† ${e.message}</span></div>`;}
};

const LOREM="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.";
const TECH="React components render efficiently using virtual DOM diffing. TypeScript interfaces ensure compile-time safety across microservices. Kubernetes orchestrates containerized workloads with autoscaling. GraphQL enables clients to request precisely the data they need. Redis caching layers dramatically reduce database load and latency.";
window.doLorem=()=>{
  const p=+document.getElementById('lrP').value,type=document.getElementById('lrT').value;
  document.getElementById('lrOut').textContent=Array.from({length:p},()=>type==='classic'?LOREM:TECH).join('\n\n');
};

window.convTS=()=>{
  const ts=+document.getElementById('tsIn').value,d=new Date(ts*(ts>1e10?1:1000));
  document.getElementById('tsRes').innerHTML=rg([['UTC',d.toUTCString()],['Local (India)',d.toLocaleString('en-IN'),'hl'],['ISO 8601',d.toISOString()],['Unix ms',d.getTime()]]);
};
window.convDT=()=>{
  const d=new Date(document.getElementById('tsDt').value),ts=Math.floor(d.getTime()/1000);
  document.getElementById('tsRes').innerHTML=rg([['Unix (seconds)',ts,true,true],['Unix (ms)',d.getTime()],['ISO 8601',d.toISOString()],['Day',d.toLocaleDateString('en-IN',{weekday:'long'})]]);
};

window.calcNB=()=>{
  try{const dec=parseInt(document.getElementById('nbIn').value.trim(),+document.getElementById('nbFr').value);
  if(isNaN(dec))throw 0;
  document.getElementById('nbRes').innerHTML=rg([['Decimal (10)',dec],['Binary (2)',dec.toString(2)],['Octal (8)','0o'+dec.toString(8)],['Hex (16)','0x'+dec.toString(16).toUpperCase()]]);
  }catch{document.getElementById('nbRes').innerHTML='<div class="result-note">‚ö† Invalid input for selected base</div>';}
};

const LNM={km:1000,m:1,cm:0.01,mm:0.001,mi:1609.344,ft:0.3048,in:0.0254,yd:0.9144};
window.calcLen=()=>{const v=+document.getElementById('lnV').value,f=document.getElementById('lnF').value,m=v*LNM[f];document.getElementById('lnRes').innerHTML=`<div class="result-box"><div class="result-grid">${Object.entries(LNM).map(([u,r])=>`<div class="result-item ${u===f?'hl':''}"><div class="rl">${u.toUpperCase()}</div><div class="rv" style="font-size:15px">${fmt(m/r,6)}</div></div>`).join('')}</div></div>`;};

const WTK={kg:1,g:0.001,mg:1e-6,lb:0.453592,oz:0.0283495,t:1000};
window.calcWt=()=>{const v=+document.getElementById('wtV').value,f=document.getElementById('wtF').value,k=v*WTK[f];document.getElementById('wtRes').innerHTML=`<div class="result-box"><div class="result-grid">${Object.entries(WTK).map(([u,r])=>`<div class="result-item ${u===f?'hl':''}"><div class="rl">${u.toUpperCase()}</div><div class="rv" style="font-size:15px">${fmt(k/r,6)}</div></div>`).join('')}</div></div>`;};

window.calcTemp=()=>{
  const v=+document.getElementById('tpV').value,f=document.getElementById('tpF').value;
  const c=f==='c'?v:f==='f'?(v-32)*5/9:v-273.15;
  document.getElementById('tpRes').innerHTML=rg([['Celsius',fmt(c,4)+' ¬∞C',f==='c'],['Fahrenheit',fmt(c*9/5+32,4)+' ¬∞F',f==='f'],['Kelvin',fmt(c+273.15,4)+' K',f==='k']]);
};

const SPM={kmh:1/3.6,ms:1,mph:0.44704,kt:0.514444,mach:340.29};
const SPLAB={kmh:'km/h',ms:'m/s',mph:'mph',kt:'Knots',mach:'Mach'};
window.calcSpd=()=>{const v=+document.getElementById('spV').value,f=document.getElementById('spF').value,ms=v*SPM[f];document.getElementById('spRes').innerHTML=`<div class="result-box"><div class="result-grid">${Object.entries(SPM).map(([u,r])=>`<div class="result-item ${u===f?'hl':''}"><div class="rl">${SPLAB[u]}</div><div class="rv" style="font-size:16px">${fmt(ms/r,4)}</div></div>`).join('')}</div></div>`;};

const ARM={sqm:1,sqkm:1e6,sqft:0.092903,acre:4046.86,ha:10000,bigha:2529};
const ARLAB={sqm:'sq.m',sqkm:'sq.km',sqft:'sq.ft',acre:'Acre',ha:'Hectare',bigha:'Bigha'};
window.calcArea=()=>{const v=+document.getElementById('arV').value,f=document.getElementById('arF').value,sm=v*ARM[f];document.getElementById('arRes').innerHTML=`<div class="result-box"><div class="result-grid">${Object.entries(ARM).map(([u,r])=>`<div class="result-item ${u===f?'hl':''}"><div class="rl">${ARLAB[u]}</div><div class="rv" style="font-size:15px">${fmt(sm/r,4)}</div></div>`).join('')}</div></div>`;};

window.copyEl=id=>navigator.clipboard.writeText(document.getElementById(id).textContent).then(()=>showToast('Copied!'));
function showToast(msg){const t=document.getElementById('toast');t.textContent='‚úì '+msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2000);}
</script>
</body>
</html>